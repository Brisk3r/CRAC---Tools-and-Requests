<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <!-- QR Code Styling Library -->
    <script type="text/javascript" src="https://unpkg.com/qr-code-styling@1.5.0/lib/qr-code-styling.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for input elements to match the theme */
        .form-input {
            @apply mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-cyan-500 focus:ring-cyan-500 sm:text-sm;
        }
        .form-label {
            @apply block text-sm font-medium text-gray-700;
        }
        /* Style for the QR code container */
        #canvas {
            width: 320px;
            height: 320px;
            margin: 0 auto;
        }
    </style>
</head>
<body class="bg-gray-100">

    <!-- Page Header -->
    <header id="page-header" class="bg-white shadow-sm">
        <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-4 flex justify-between items-center">
            <h1 class="text-xl font-bold text-cyan-700">QR Code Generator</h1>
            <a href="index.html" class="text-sm font-medium text-cyan-600 hover:text-cyan-800">&larr; Back to Tools Hub</a>
        </div>
    </header>

    <div class="flex flex-col lg:flex-row">
        <!-- Controls Section -->
        <aside id="controls" class="w-full lg:w-1/3 p-6 bg-white lg:h-screen lg:sticky lg:top-0 overflow-y-auto">
            <h2 class="text-2xl font-bold mb-6">Customise Your QR Code</h2>
            <div class="space-y-6">
                
                <!-- Data Input -->
                <div>
                    <label for="url" class="form-label">URL or Text</label>
                    <input type="text" id="url" class="form-input" value="https://www.clarencevalley.nsw.gov.au/Community/Venues-and-facilities/Aquatic-centres">
                </div>

                <!-- Color Pickers -->
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="dot-color" class="form-label">Dot Color</label>
                        <input type="color" id="dot-color" class="form-input h-10" value="#0d68cc">
                    </div>
                    <div>
                        <label for="background-color" class="form-label">Background Color</label>
                        <input type="color" id="background-color" class="form-input h-10" value="#ffffff">
                    </div>
                </div>

                <!-- Style Options -->
                <div>
                    <label for="dot-style" class="form-label">Dot Style</label>
                    <select id="dot-style" class="form-input">
                        <option value="square">Square</option>
                        <option value="dots">Dots</option>
                        <option value="rounded">Rounded</option>
                        <option value="extra-rounded">Extra Rounded</option>
                        <option value="classy">Classy</option>
                        <option value="classy-rounded">Classy Rounded</option>
                    </select>
                </div>
                
                <div>
                    <label for="corner-square-style" class="form-label">Corner Square Style</label>
                    <select id="corner-square-style" class="form-input">
                        <option value="square">Square</option>
                        <option value="dot">Dot</option>
                        <option value="extra-rounded">Extra Rounded</option>
                    </select>
                </div>

                <!-- Logo Upload -->
                <div>
                    <label class="form-label">Centre Logo (Optional)</label>
                    <div class="mt-1 flex items-center">
                        <input type="file" id="logo-upload" class="hidden" accept="image/png, image/jpeg, image/svg+xml">
                        <button type="button" onclick="document.getElementById('logo-upload').click()" class="text-sm bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded-md">
                            Upload Image
                        </button>
                        <button type="button" id="remove-logo" class="ml-2 text-sm text-red-600 hover:text-red-800">Remove</button>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">PNG, JPG, or SVG. Will be placed in the center.</p>
                </div>

                <!-- Download Button -->
                <div class="pt-4">
                    <button id="download-btn" class="w-full bg-cyan-600 text-white font-bold py-3 px-4 rounded-md hover:bg-cyan-700 focus:outline-none focus:ring-2 focus:ring-cyan-500 focus:ring-offset-2 flex items-center justify-center">
                        <svg class="w-5 h-5 mr-2" xmlns="http://www.w.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3" /></svg>
                        Download PNG
                    </button>
                </div>
            </div>
        </aside>

        <!-- QR Code Preview -->
        <main class="w-full lg:w-2/3 p-8 flex items-center justify-center">
            <div id="canvas"></div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ELEMENT REFERENCES ---
            const urlInput = document.getElementById('url');
            const dotColorInput = document.getElementById('dot-color');
            const backgroundColorInput = document.getElementById('background-color');
            const dotStyleSelect = document.getElementById('dot-style');
            const cornerSquareStyleSelect = document.getElementById('corner-square-style');
            const logoUploadInput = document.getElementById('logo-upload');
            const removeLogoBtn = document.getElementById('remove-logo');
            const downloadBtn = document.getElementById('download-btn');
            
            let uploadedLogo = null;

            // --- QR CODE INITIALIZATION ---
            const qrCode = new QRCodeStyling({
                width: 320,
                height: 320,
                data: urlInput.value,
                image: '',
                dotsOptions: {
                    color: dotColorInput.value,
                    type: dotStyleSelect.value
                },
                backgroundOptions: {
                    color: backgroundColorInput.value,
                },
                cornersSquareOptions: {
                    type: cornerSquareStyleSelect.value
                },
                imageOptions: {
                    crossOrigin: "anonymous",
                    margin: 10
                }
            });

            // Append the QR code to the canvas container
            qrCode.append(document.getElementById("canvas"));

            // --- EVENT LISTENERS ---
            const updateQrCode = () => {
                qrCode.update({
                    data: urlInput.value || ' ', // Use space if empty to avoid errors
                    dotsOptions: {
                        color: dotColorInput.value,
                        type: dotStyleSelect.value
                    },
                    backgroundOptions: {
                        color: backgroundColorInput.value
                    },
                    cornersSquareOptions: {
                        type: cornerSquareStyleSelect.value
                    },
                    image: uploadedLogo
                });
            };

            // Add listeners to all controls
            urlInput.addEventListener('input', updateQrCode);
            dotColorInput.addEventListener('input', updateQrCode);
            backgroundColorInput.addEventListener('input', updateQrCode);
            dotStyleSelect.addEventListener('change', updateQrCode);
            cornerSquareStyleSelect.addEventListener('change', updateQrCode);

            // Listener for logo upload
            logoUploadInput.addEventListener('change', (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    uploadedLogo = e.target.result;
                    updateQrCode();
                };
                reader.readAsDataURL(file);
            });

            // Listener for removing the logo
            removeLogoBtn.addEventListener('click', () => {
                uploadedLogo = null;
                logoUploadInput.value = ''; // Clear the file input
                updateQrCode();
            });

            // Listener for the download button
            downloadBtn.addEventListener('click', () => {
                qrCode.download({ name: "crac-qrcode", extension: "png" });
            });
        });
    </script>

</body>
</html>
